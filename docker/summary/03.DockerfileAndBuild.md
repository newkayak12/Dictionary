# CoreConcept

## Build
도커에서 빌드는 기반이 되는 이미지를 바탕으로 수정을 통해서 이미지를 생성하는 것을 의미한다. 
이 과정에서 컨테이너에 필요한 패키지, 추가해야 하는 소스 코드, 실행해야 하는 명령어, 필요한 쉘 스크립트 등을 포함시킬 수 있다.

## Dockerfile
이러한 과정을 기술한 설계도가 `Dockerfile`이다. Dockerfile을 사용하면 직접 컨테이너를 생성하고 이미지로 커밋하는 번거로움을 덜 수 있다.
또한 hub에 이미지 대신 Dockerfile 배포로 이미지 배포를 대신할 수 있다. ( Dockerfile이 이미지를 만드는 방법을 적어 놓은 것이기 때문에 가능하다.)

## 명령어

|Instruction|	Description| SUPPORT VARIABLE |
|:---:|:---:|:----------------:|
|ADD|	Add local or remote files and directories.|        O         |
|ARG|	Use build-time variables.|        X         |
|CMD|	Specify default commands.|        X         |
|COPY|	Copy files and directories.|        O         |
|ENTRYPOINT|	Specify default executable.|        X         |
|ENV|	Set environment variables.|        O         |
|EXPOSE|	Describe which ports your application is listening on.|        O         |
|FROM|	Create a new build stage from a base image.|        O         |
|HEALTHCHECK|	Check a container's health on startup.|        X         |
|LABEL|	Add metadata to an image.|        O         |
|MAINTAINER|	Specify the author of an image.|        X         |
|ONBUILD|	Specify instructions for when the image is used in a build.|        O         |
|RUN|	Execute build commands.|        X         |
|SHELL|	Set the default shell of an image.|        X         |
|STOPSIGNAL|	Specify the system call signal for exiting a container.|        O         |
|USER|	Set user and group ID.|        O         |
|VOLUME|	Create volume mounts.|        O         |
|WORKDIR|	Change working directory.|        O         |


### ParserDirective
빌드 타임에 레이어를 쌓거나하는 건 아니지만 영향을 주는 어노테이션과 유사하다.

1. syntax : dockerfile의 버전을 명시한다.
2. escape : 문자열 이스케이핑에 대한 명시를 한다.

### Environment Replacement
환경 변수를 변수에 담아서 관리할 수 있다.  `$variable_name`, `${variable_name}`과 같은 형식으로 작성한다.

1. ${variable:-word} : variable에 변수 할당이 없으면 word를 default로 뱉는다.
2. ${variable:+word} : variable이 있으면 word를 뱉고 아니면 빈 문자열을 뱉는다.
3. ${variable#pattern} : variable에서 pattern과 일치하는 문자를 삭제한다.


### .dockerignore
빌드타임에 컨텍스트에서 파일, 디렉토리를 제외한다.

### exec, shell

실행 명령을
1. 명령어 ["순서", "대로", "기술"]
2. 명령어 command 순서 대로

와 같이 작성할 수 있다.



[참고 문헌](https://docs.docker.com/reference/dockerfile/#shell-and-exec-form)

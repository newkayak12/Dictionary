# 이미지, 컨테이너

## 이미지
이미지는 컨테이너 생성이 필요한 요소다. 이미지는 파이같이 여러 개의 계층으로 된 바이너리 파일로 존재하고 컨테이너 생성하고 실행할 때
읽기 전용으로 사용된다.

> [저장소 이름]/[이미지이름]:[태그]
> 
> 저장소 : 이미지가 저장된 장소. 만일 명시되어 있지 않으면 기본 값은 도커 허브에 올라가 있다는 의미가 된다.
> 이미지 이름 : 이미지의 역할을 지칭하는 이름이다. amazoncorretto같이 말이다.
> 태그 : 주로 버전 관리에 사용된다 명시하지 않으면 latest가 된다.

와 같이 구성되어 있다.


## 컨테이너

위에서 설명한 이미지로 컨테이너를 생성할 수 있다. 이미지의 목적에 맞는 파일이 들어 있는 파일시스템과 격리된 시스템 자원 및
네트워크를 사용할 수 있는 독립된 공간이 생성된다.

컨테이너는 이미지를 읽기 전용으로 사용하되, 이미지에서 변경된 사항만 컨테이터 계층에 저장한다. 또한 생성된 각 컨테이너는 각기 독립된 파일 시스템을 제공받으며
호스트와 분리돼 있으므로 특정 컨테이너에서 어떤 애플리케이션을 설치하거나 삭제해도 다른 컨테이너와 호스트에는 영향이 없다. 


> docker run -it ubuntu:21 

와 같이 컨테이너를 실행할 수 있다. `-i`는 interaction, `-t`는 teleTypeWriter로 TTY라고 한다. 표준 입력에 연결된 터미널의 파일 이름을 출력하기 위한 명령어다.
컨테이너, 호스트의 파일 시스템은 서로 독립적이므로 내부에서는 아무 것도 설치되어 있지 않다.

> docker create -it --name [name] image

위 명령어로 실행을 바로 하는 것이 아닌 컨테이너를 만들 수 있다.  `--name`은 컨테이너 이름을 지정하는 명령어다.


### 옵션

|        option        |                              description                              |
|:--------------------:|:---------------------------------------------------------------------:|
|     --cpu-period     |                         Limit CPU CFS period                          |
|     --cpu-quota      |                          LIMIT CPU CFS quota                          |
|   --cpu-shares, -c   |                          CPU share(상대적 가중치)                           |
|        --cpus        |                            Number of CPUs                             |
|     --entrypoint     |             overwrite the default ENTRYPOINT of the image             |
|      -e, --env       |                       Set environment variables                       |
|      --env-file      |                 read in file of environment variables                 |
|       --expose       |                   Expose a port or a range of ports                   |
|     --health-cmd     |                    command to run to check health                     |
|  --health-interval   |               the between running the check (ms/s/m/h)                |
|   --health-retries   |              consecutive faiures need to report unhealth              |
|   --health-timeout   |           maximum time to allow one check to run (ms/s/m/h)           |
|  -i, --interactive   |                 Keep STDIN open even if not attached                  |
|     -l, --label      |                     set meta data on a container                      |
|        --link        |                    add link to anothjer container                     |
|   --link-local-ip    |                container IPv4, IPv6 link-local address                |
|     --log-driver     |                   logging driver for the container                    |
|      --log-opt       |                          log driver options                           |
|     -m, --memory     |                             memory limit                              |
| --memory-reservation |                           memory soft limit                           |
|    --memory-swap     |  swap limit equal to memory plus swap: '-1' to enable unlimited swap  |
| --memory-swappiness  |       tun container memory swappiness( 0 to 100 [default : -1])       |
|       --mount        |              attach a filesystem mount to the container               |
|        --name        |                    assign a name to the container                     |
|      --network       |                   connect a container to a network                    |
|   --network-alias    |              add network-scoped alias for the container               |
|   --no-healthcheck   |              disable any container-specified HEALTHCHECK              |
|  --oom-kill-disable  |                          disable OOM killer                           |
|   --oom-score-adj    |               tun host's OOM preferences( -1000 ~ 1000)               |
|        --pid         |                         PID namespace to use                          |
|     --privileged     |              give extended privileges to this container               |
|    -p, --publish     |               publish a container's port(s) to the host               |
|  -P, --publish-all   |              publish all expoesed ports to random ports               |
|        --pull        | pull image before creating(always, missing, never [default: missing]) |
|     --read-only      |          Mount the container's root filesystem as read only           |
|      --restart       |    Restart policy to apply when a container exists([default: no])     |
|    --stop-signal     |                     signal to stop the container                      |
|       --ulimit       |                             ulimit option                             |
|     -v, --volume     |                          Bind mount a volume                          |
|   --volume-driver    |               Optional volume driver for the container                |
|    --volumes-from    |             Mount volumes from the specified container(s)             |
|    -w, --workdir     |                Working directory inside the container                 |



[참고 문헌](https://docs.docker.com/reference/cli/docker/container/create/)

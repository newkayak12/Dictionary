### Topic-Partition-Replication 구조

**기본 관계**

- **Topic : Partition = 1 : N**
- **Partition : Replica = 1 : N** (Replication Factor 만큼)

```
Topic: order-events
├── Partition 0
│   ├── Leader: Broker A ← 모든 읽기/쓰기 처리
│   ├── Follower: Broker B (복제본)
│   └── Follower: Broker C (복제본)
├── Partition 1
│   ├── Leader: Broker B ← 모든 읽기/쓰기 처리
│   ├── Follower: Broker A (복제본)
│   └── Follower: Broker C (복제본)
└── Partition 2
    ├── Leader: Broker C ← 모든 읽기/쓰기 처리
    ├── Follower: Broker A (복제본)
    └── Follower: Broker B (복제본)
```
### Partition Leader의 역할

**각 Partition마다 하나의 Leader Broker**

- 해당 Partition의 모든 Producer 요청 처리
- 해당 Partition의 모든 Consumer 요청 처리
- Follower들의 복제 요청(Fetch) 처리
- ISR(In-Sync Replicas) 관리

### Replication 동작 원리

1. 쓰기 과정
Producer → Partition Leader → Follower들이 Pull로 복제

2. 읽기 과정
Consumer ← Partition Leader (Follower에서는 읽기 불가)

3. Leader 장애 시

- Controller Broker가 ISR 중에서 새 Leader 선출
- 새 Leader가 모든 요청 처리 담당
- 기존 Leader는 복구 후 Follower로 참여

### 물리적 저장소 분산

**Broker 3대 클러스터 기준**

- Topic 1개 → Partition 3개 → Replica 9개 (3×3)
- 각 Broker마다 3개의 Replica 저장
- Leader/Follower 역할이 Broker별로 골고루 분산

### 핵심 포인트

- **Partition 단위로 Leader/Follower 구분**
- **각 Partition은 독립적으로 복제 관리**
- **Producer/Consumer는 항상 Leader와 통신**
- **Replication Factor = 각 Partition의 복제본 수**
### 개념

- **동일한 Topic을 협력하여 소비하는 Consumer들의 집합**
- 각 Consumer Group은 **고유한 Group ID** 보유
- **Load Balancing과 Fault Tolerance**를 위한 핵심 메커니즘
- Partition 배정은 Kafka가 중재한다.
	- 중복 방지
	- 공평한 분재
	- 장애 시 재분배
- 같은 일을 나눠서 하는 Consumer들의 팀
- 동일 Topic을 여러 Consumer Group에 등록 가능
- 같은 Topic을 여러 Group이 독립적으로 소비


### Consumer Group의 목적
- **병렬 처리**: 여러 Consumer가 서로 다른 Partition 동시 처리
- **확장성**: Consumer 추가로 처리 능력 증대
- **고가용성**: 한 Consumer 장애 시 다른 Consumer가 대신 처리

### Partition 할당 원칙

- **하나의 Partition = 하나의 Consumer** (Group 내에서)
- **하나의 Consumer = 여러 Partition 가능**
- **Consumer 수 > Partition 수**: 일부 Consumer는 유휴 상태

### Group 간 독립성

- **서로 다른 Group = 독립적으로 동일 Topic 소비**
- **각 Group별로 독립적인 Offset 관리**
- **Multi-tenancy**: 여러 서비스가 동일 데이터 각자 처리

---

### **1. Consumer 수 최적화**

- **이상적 비율**: Consumer 수 = Partition 수
- **Under-provisioned**: Consumer < Partition (일부 Consumer가 과부하)
- **Over-provisioned**: Consumer > Partition (일부 Consumer 유휴)

### **2. 확장 패턴**

- **Horizontal Scale**: Consumer 인스턴스 추가
- **Vertical Scale**: Consumer 처리 능력 향상
- **Auto Scaling**: Consumer Lag 기반 자동 확장

### **3. Multi-Consumer Group 설계**

- **Processing Group**: 실시간 비즈니스 로직 처리
- **Analytics Group**: 데이터 분석 및 집계
- **Backup Group**: 데이터 백업 및 아카이빙
- **Monitoring Group**: 메트릭 수집 및 알람

### **4. Partition 전략과 연관성**

- **Key-based**: 동일 Key → 동일 Consumer (순서 보장)
- **Round-robin**: 전체 Consumer에 고르게 분산
- **Custom Assignment**: 비즈니스 로직에 맞는 할당

### **5. 장애 처리 전략**

- **Consumer 장애**: 다른 Consumer가 해당 Partition 인수
- **전체 Group 장애**: 다른 Group은 영향 없이 계속 동작
- **Split-brain 방지**: Coordinator를 통한 중앙 집중 관리

### **6. Performance Tuning**

- **Session Timeout**: Consumer 생존 확인 주기
- **Heartbeat Interval**: 생존 신호 전송 주기
- **Max Poll Records**: 한 번에 가져올 레코드 수
- **Processing Time**: poll() 간격 최적화

### 7. Rebalancing 발생 조건
- **Consumer 변경**: 추가/제거/장애
- **Partition 변경**: Partition 수 증가 시 새 담당자 배정 필요
### 개념
- Consumer가 **"여기까지 처리했다"**고 Kafka에 알리는 행위
- 처리 완료된 **Offset 위치를 기록**하는 과정
- Consumer 재시작 시 **마지막 Commit된 위치부터 재개**

### Commit vs Read Offset
- **Read Offset**: Consumer가 현재 읽고 있는 위치
- **Committed Offset**: Kafka에 저장된 마지막 처리 완료 위치
- 장애 시 Committed Offset부터 재시작

### Auto Commit vs Manual Commit
**Auto Commit**

- `enable.auto.commit=true` (기본값)
- `auto.commit.interval.ms=5000` (5초마다 자동)
- **편리하지만** 메시지 손실/중복 가능성
**Manual Commit**

- 처리 완료 후 명시적으로 `commitSync()` 호출
- **안전하지만** 구현 복잡성 증가

### Commit 저장 위치

- **`__consumer_offsets` Topic**: Consumer Group별 Offset 저장
- **50개 Partition**: 확장성을 위한 분산 저장
- **Replication Factor=3**: 고가용성 보장

---
### **1. Commit 전략별 Trade-off**
- **빈번한 Commit**: 안전하지만 성능 저하
- **배치 Commit**: 성능 좋지만 중복 처리 위험
- **Processing Time 고려**: 처리 시간보다 짧은 주기로 Commit

### **2. Exactly-Once with Transactions**
- **Transactional Producer**: 중복 방지를 위한 Idempotent 처리
- **Transaction Coordinator**: 분산 트랜잭션 관리
- **Atomic Commit**: Producer 쓰기 + Consumer Offset Commit 원자적 처리

### **3. Consumer Lag과 Commit**
- **Lag 증가 원인**: Commit 지연으로 인한 재처리
- **Monitoring**: Committed vs Current Offset 차이 추적
- **Alert 기준**: 임계값 초과 시 장애 알림

### **4. 장애 시나리오별 대응**
- **Commit 전 Consumer 죽음**: 마지막 Commit부터 재처리 (중복)
- **처리 후 Commit 실패**: 메시지 재처리될 수 있음
- **Network Partition**: Commit 지연으로 인한 Rebalancing

### **5. 최적화 전략**
- **Async Commit**: 성능 향상을 위한 비동기 Commit
- **Commit Callback**: 실패 시 재시도 로직
- **Batch Size 조절**: 처리량과 Commit 빈도 균형

### **6. 실무 권장사항**
- **중요 데이터**: Manual Commit + Sync 방식
- **로그 수집**: Auto Commit으로 성능 우선
- **금융 데이터**: Transactional 방식 필수
- **모니터링**: Consumer Lag 지속적 추적
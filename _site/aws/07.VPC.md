
# VPN(Virtual Private Network)
가상의 네트워크 망을 구성하는 것을 의미한다. 이렇게 되면 다른 네트워크에 있더라도 한 네트워크에 있는 것처럼 동작하게 할 수 있다.


# VPC(VirtualPrivateCloud)

VPC를 적용하면 VPC 별로 네트워크를 격리하거나 VPC 별로 네트워크 설정을 줄 수 있다. 각  VPC는 완전히 다른 네트워크처럼 작동한다.
사용자는 VPC 내에서 IP대역, 인터페이스, 서브넷, 라우팅 테이블, 인터넷 게이트웨이, 보안 그룹, ACL 등을 생성하고 제어할 수 있다.

![vpc.png](img%2Fvpc.png)

가상 사설망, 가상 사설망은 공인 아이피 - 공유기 환경과 유사하다. 외부와는 관련 없는 내부 망을 구성하는 것을 의미한다.
VPC에서는 ip를 새로 할당 할 수 있다. 이 IP는 `RFC1918`에 부합해야 한다.

| CIDR 표기 | IP 범위 |
|:---:|:---:|
|10.0.0.0/8|10.0.0.0 ~ 10.255.255.255|
|     172.16.0.0/12    |  172.16.0.0~172.31.255.255     |
|     192.168.0.0/16    |     192.168.0.0~192.168.255.255  |


# 서브넷
- 퍼블릭 : 외부와 자유로운 통신이 가능하다.
- 프라이빗 : 외부에서 접근할 수 없다. 내부에서 외부로 나갈 때 NAT Gateway를 통해서 내보낼 수 있다.

## IP 주소 구성
아이피는 네트워크ID(국가별) + 호스트ID로 구성된다. 예를 들어서 192.168.10.10 => 11000000.10101000.00001010.00001010가 되고
11000000.10101000.00001010가 네트워크 ID라면 00001010가 호스트가 된다.

## 클래스
11000000.10101000.00001010.00001010 는 총 32bit로 8비트마다 하나의 옥텟이 된다. 클래스는 이미 사용하지 않지만  네트워크 ID가 차지하는 길이에 따라서
A,B,C로 클래스를 나눌 수 있다.

- classA : Net.Host.Host.host -> Network의 첫 옥텟 비트는 0으로 고정
- classB : Net.Net.Host.host ->  Network의 첫번째, 두번째 옥텟 비트는 1,0으로 고정
- classC : Net.Net.Net.host ->  Network의 첫번째, 두번째, 세번쨰 옥텟 비트는 1,1,0으로 고정

## 서브넷
IPv4가 부족하던 시기 IP를 클래스로 나눠서 할당하는 방법을 택했다. 그러나 그래도 부족하게 되어 서브넷 개념이 등장하게 되었다. 
1. subnet은 네트워크가 분할되어 나눠진 작은 네트워크다.
2. 서브넷을 만들기 위해서 분할하는 것을 서브네팅이라고 한다.
3. 서브네팅은 서브넷 마스크를 통해서 계산되어 수행된다.

## 서브넷 마스크
IP주소에서 네트워크 ID와 호스트ID로 구분하기 위해서 만들어졌다. 서브넷 마스크는 IP주소와 똑같은 32비트 2진수로 표현된다.
아이피와 다른 점은 연속된 1, 연속된 0으로 구성되어 있다.

> 10011111.11011111.11110011.00000000 같은 경우가 아니라
> 11111111.11111111.11111100.00000000 같이 말이다.

서브넷 마스크로 네트워크 ID, 호스트 ID를 보다 편리하게 구분할 수 있다.

| Class |                대역                 | default Subnet Mask |
|:-----:|:---------------------------------:|:-------------------:|
|   A   |     1.0.0.0 ~ 127.255.255.255     |      255.0.0.0      |
|   B   | 128.0.0.0.0 ~ 191.255.255.255.255 |     255.255.0.0     |
|   C   |   192.0.0.0.0 ~ 233.255.255.255   |    255.255.255.0    |


더 간소화하면 `192.168.0.1/24`로 표현할 수 있고 `/24`는 서브넷 마스크를 표현한 것이다. 앞에서 부터 차례대로 1의 개수가 24개라는 의미다.

- 10.10.10.10/8 -> networkId 10
- 172.16.1.10/16 -> networkId 172.16
- 192.168.10.100/24 -> networkId 192.168.10

## 서브네팅
IP를 효율적으로 쪼개서 사용하는 방법을 말한다. 네트워크 성능 보장, 자원을 효율적으로 분배하기 위해서 네트워크 영역과 호스트 영역을 쪼개는 작업을 행한다.


## CIDR(Classless Inter-Domain Routing)
클래스 없는 도메인간 라우팅 기법이라는 뜻이다. 도메인 간 라우팅에 사용되는 인터넷 주소를 원래 IP주소 클래스 체계를 쓰는 것보다 더욱 유연하게 사용할 수 있도록 한 
방식 중 하나다.
서브네팅은 IP 클래스에 국한되지 않고 잘게 쪼개는 방식을 의미하는데 이는 클래스 없는 도메인간 라우팅 기법으로 볼 수 있다. 

### 표기
`A.B.C.D/N`으로 표기할 수 있다. 이렇게 표기하면 네트워크 범위를 바로 추측할 수 있기 때문이다.

예를 들어 `192.168.10.70/26`이라고 하면 서브넷 마스크는 `255.255.255.192`가 될 것이다.

1. 256 - 19 - 2(특수목적)으로 62개의 호스트를 가질 수 있다.
2. 256 / 64으로 4개의 서브넷을 가진다는 것을 알 수 있다.

|Network|대역|
|:---:|:---:|
|네트워크 1| 192.168.10.0 ~ 192.168.10.63|
|네트워크 2| 192.168.10.64 ~ 192.168.10.127|
|네트워크 3| 192.168.10.128 ~ 192.168.10.191|
|네트워크 4| 192.168.10.192 ~ 192.168.10.255|

1, 4는 사용이 불가하다. 또한 70으로 끝났으니 네트워크2에 속한다는 것을 알 수 있다.



### AWS에서는

위의 경우 네트워크 구조(10.0.0.0), 브로드캐스트주소(10.0.0.255)로 2개를 제외해야 했지만

|     IP     |                      설명                      |
|:----------:|:--------------------------------------------:|
|  10.0.0.0  |                   네트워크 주소                    |
|  10.0.0.1  |               AWS VPC 라우터용 예약                |
|  10.0.0.2  | DNS 서버 주소 (DNS 서버 주소는 VPC 네트워크 범위에 2를 더한 주소) |
|  10.0.0.3  |            AWS에서 앞으로 사용하려고 예약한 주소            |
| 10.0.0.255 |                네트워크 브로드캐스트 주소                |

## Region, AZ, EdgeLocation, RegionalEdgeCache

AWS 인프라는 Region, AZ, EdgeLocation, RegionalEdgeCache으로 나뉜다.

1. Region : 물리적으로 서버가 있는 위치를 의미한다.
2. Availability Zone (AZ) : 각 리전 안에서 나뉜 데이터 센터 정도로 보면 된다. 예를 들어 Seoul 리전에는 4개의 AZ가 있다.
3. Edge Location : aws의 cdn들의 여러 서비스들을 캐싱하기 위한 거점을 의미한다. CloudFront, Route53의 캐시 서버를 의미한다.
4. Reional Edge Cache : CloudFront의 오리진 서버와 에지 로케이션 사이에 위치해 있다.


## 라우팅 테이블
서브넷 혹은 게이트웨이를 통해서 네트워크 트래픽이 어디로 향하는지에 대해서 결정될 때 사용하는 룰을 포함




[참고문헌](https://medium.com/harrythegreat/aws-%EA%B0%80%EC%9E%A5%EC%89%BD%EA%B2%8C-vpc-%EA%B0%9C%EB%85%90%EC%9E%A1%EA%B8%B0-71eef95a7098)
[참고문헌](https://velog.io/@yenicall/AWS-VPC%EC%9D%98-%EA%B0%9C%EB%85%90)
[참고문헌](https://aws.amazon.com/ko/blogs/architecture/its-adopts-microservices-architecture-for-improved-air-travel-search-engine/)
[참고문헌](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/vpc-network-acls.html)
[참고문헌](https://aws.amazon.com/ko/vpc/features/)
[참고문헌](https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/what-is-amazon-vpc.html)
[참고문헌](https://medium.com/harrythegreat/aws-가장쉽게-vpc-개념잡기-71eef95a7098)
[참고문헌](https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-VPC-%EC%82%AC%EC%9A%A9-%EC%84%9C%EB%B8%8C%EB%84%B7-%EC%9D%B8%ED%84%B0%EB%84%B7-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4-NAT-%EB%B3%B4%EC%95%88%EA%B7%B8%EB%A3%B9-NACL-Bastion-Host#ip_%ED%81%B4%EB%9E%98%EC%8A%A4_%E2%80%A2_%EC%84%9C%EB%B8%8C%EB%84%B7_%EB%A7%88%EC%8A%A4%ED%81%AC_%E2%80%A2_%EC%84%9C%EB%B8%8C%EB%84%B7%ED%8C%85_%EC%99%84%EB%B2%BD_%EC%A0%95%EB%A6%AC)


# Cursor/ Record/ Collection

## 1. 커서란
특정 SQL 문장을 처리하 결과를 담고 있는 영역(PRIVATE SQL이라는 메모리)을 가리키고 일종의 포인터
종류는 묵시/ 명시적 커서가 있다. 묵시적 커서는 오라클 내부에서 자동으로 생성되어 사용하는 커서이다. 반대로 사용자가 직접 정의해서 사용하는 커서를 명시적 커서라고 한다.

a. 명시적 커서 
```sql
DECLARE
 vn_department_id emplyees.departmnet_id%TYPE := 80;
BEGIN 
 UPDATE emplyess
 SET emp_name = emp_name
 where department_id = vn_department_id;

 DBMS_OUTPUT.PUT_LINE(SQL%ROWCOUNT); -- oracle
 COMMIT;
END
```
묵시적 커서 속성

|    속성명     |                          설명                           |
|:----------:|:-----------------------------------------------------:|
| SQL%FOUND  |              결과 집합의 패치 로우 수가 1 이상이면 TRUE              |
| SQL%NOTFOUND |               결과 집합의 패치 로우 수가 0이면 TRUE                |
| SQL%ROWCOUNT |              영향 받은 결과 집합의 로우 수 반환, 없으면 0              |
|  SQL%ISOPEN  | 묵시적 커서는 항상 FALSE 반환( 이 속성으로 참조할 때는 이미 묵시적 커서는 닫힌 상태 ) |

b.명시적 커서
커서 선언 - 커서 열기 - 패치 단게에서 커서 사용 - 커서 닫기

1. 커서 선언

    묵시적 커서와 달리 명시적 커서는 선언해야 한다. 명시적 커서는 결과 데이터 집합을 로우별로 참조하는 용도이므로 SELECT 문을 사용할 것이다.
    ```sql
    CURSOR 커서명 [(매개변수1, ...2)] 
        IS
    SELECT ...;
    ```

2. 커서 열기
    ```sql
    OPEN 커서명 [(매개변수1, ...2)];
    ```

3. 패치에서 커서 사용
    ```sql
    LOOP
     FETCH 커서명 INTO 변수 1, ...;
     EXIT WEHN 커서명%NOTFOUND;
    END LOOP;
    ```

4. 커서 닫기
    ```sql
    CLOSE 커서명;
    ```

    ex)
    ```sql
    FOR record IN cursorName (매개변수)
        LOOP
            executtion;
        END LOOP;
    ```
   

## 2. 커서 변수
명시적 커서의 이름은 상수이다. 한 번 할당하면 다른 값으로 바꿀 수 없다. 대신 커서 변수라는 것이 있다. 
- 한 개 이상의 쿼리를 연결해서 사용할 수 있다.
- 변수처럼 커서 변수를 함수나 프로시저의 매개변수로 전달할 수 있다. 
- 커서 속성을 사용할 수 있다. 